---
title: "EES-Data-Screener-Report"
author: "Cam Race"
date: "12 September 2019"
output: 
  rmarkdown::html_document:
    theme: darkly
---
cameron.race@education.gov.uk
```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r library, include=FALSE}
library(tidyverse)
```
## Files tested
```{r files, echo=TRUE, results='hide', warning=FALSE, message=FALSE}
dataset <- read_csv("data_metadata/4and6digit_simple.csv")
metadata <- read_csv("data_metadata/4and6digit_simple.meta.csv")
```

```{r setup, include=FALSE}
source("setup_file.R")
```
## Data file validation
Checking that the compulsory columns are present
```{r data_comp_col, echo=FALSE,comment=NA}
data_comp_col(dataset)
```

Checking that the time_period is either 4 or 6 digits
```{r time_period_check, echo=FALSE,comment=NA}
time_period_check(dataset)
```
  
 Checking that any 6 digit time_periods refer to consecutive years
```{r echo=FALSE,comment=NA}
try(cat(time_period_check_consecutive(dataset)))
```

 Checking if the time_identifier values are valid
```{r time_identifier_check,comment=NA,echo=FALSE}
time_identifier_check(dataset)
```

 Check this list for conceptually different time_identifiers
```{r time_identifier_mix, echo=FALSE, comment="Time_identifiers: "}
time_identifier_mix(dataset)
```

 Checking for commas in the data file
```{r comma_check,echo=FALSE,comment=NA}
comma_check(dataset)
```

 Checking for spaces in the data file variable names
```{r data_spaces_check,echo=FALSE,comment=NA}
data_spaces_check(dataset)
```

 Checking that the correct geography columns are present for the levels in the data file
```{r geography_levels_present,include=FALSE,comment=NA}
#geography_levels_present(data) - needs working on
```

 Checking that the correct geography columns are completed for each of the levels in the data file
```{r geography_level_completed,include=FALSE,comment=NA}
#geography_level_completed(data) - needs working on
```

 Checking something about filter levels
```{r filter_levels_check,include=FALSE,comment=NA}
#filter_levels_check(data) - needs working on
```

 Checking that each filter has a 'Total'
```{r total_check,include=FALSE,comment=NA}
#total_check(data) - needs working on
```

## Metadata validation

 Checking that the compulsory columns are present
```{r meta_comp_col,echo=FALSE,comment=NA}
meta_comp_col(metadata)
```

 Checking for commas
```{r meta_comma_check,echo=FALSE,comment=NA}
meta_comma_check(metadata)
```

 Checking if col_name is completed for every row
```{r col_name_completed,echo=FALSE,comment=NA}
col_name_completed(metadata)
```

 Checking for duplicate col_names
```{r meta_duplicate_check,echo=FALSE,comment=NA}
meta_duplicate_check(metadata)
```

 Checking for spaces in the values in the col_name column
```{r col_name_spaces_check,echo=FALSE,comment=NA}
col_name_spaces_check(metadata)
```

 Checking if any observational units have been erroneously included in the metadata
```{r comp_col_check_meta,echo=FALSE,comment=NA}
comp_col_check_meta(metadata)
```

```{r col_type_check,include=FALSE,comment=NA}
#col_type_check(meta) - needs reworking
```

 Checking that every row has a label completed
```{r label_check,echo=FALSE,comment=NA}
label_check(metadata)
```
 
 Checking that there are no duplicate labels
```{r duplicate_label_check,echo=FALSE,comment=NA}
duplicate_label_check(metadata)
```

 Checking that no filters have an indicator group
```{r indicator_group_check,echo=FALSE,comment=NA}
indicator_group_check(metadata)
```

 Checking that all indicator units are valid values
```{r indicator_unit_validation,echo=FALSE,comment=NA}
#indicator_unit_validation(metadata) - needs reworking
```

 Checking that no filters have an indicator unit
```{r indicator_unit_check,echo=FALSE,comment=NA}
indicator_unit_check(metadata)
```

 Checking that no indicators have a filter hint
```{r filter_hint_check,echo=FALSE,comment=NA}
filter_hint_check(metadata)
```

 Checking that no indicators have a filter group
```{r filter_group_check,echo=FALSE,comment=NA}
filter_group_check(metadata)
```

 Cross checking the columns in the metadata are in the data file
```{r column_crosscheck,echo=FALSE,comment=NA}
#column_crosscheck(dataset,metadata) - needs working on
```

 Checking that the number of rows in the metadata is less than the number of columns in the data file
```{r row_check,echo=FALSE,comment=NA}
row_check(dataset,metadata)
```

 Checking filter groups on something
```{r filter_group_match,echo=FALSE,comment=NA}
#filter_group_match(dataset) - needs working on
```